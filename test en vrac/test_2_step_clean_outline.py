outline = '''

# [00:00] Chapter title : - Sur la plan�te Displate...
## [00:00] Introduction
### [00:00] Sponsorship and Chapter Title
## [00:04] The Alien Planet
### [00:04] Description of the Planet
### [00:07] Comparison to Earth
## [00:09] Signs of Life
### [00:09] Discovery of the Signal
### [00:11] Discussion of the Signal's Meaning
## [00:14] The Nostromo
### [00:14] Introduction to the Spaceship
### [00:16] Description of the Ship's Interior
## [00:19] The Crew
### [00:19] Characterization of the Crew
### [00:21] Discussion of the Crew's Motivations
## [00:24] The Captain's Decision
### [00:24] Decision to Investigate the Signal
### [00:26] Discussion of the Risks Involved
## [00:29] Conclusion
### [00:29] Summary of the First Part
### [00:31] Preview of the Next Part

# [00:10] Introduction to the Crew
## [00:10] Characterization of Kane and Dallas
### [00:11] Kane's Proximity to the Truth
### [00:11] Dallas's Leadership and Authority
## [00:11] Discussion of the Crew's Motivations
### [00:11] Parker's and Brett's Concerns
### [00:11] Dallas's Decision to Investigate the Signal
## [00:11] The Significance of the Signal
### [00:11] The Possibility of Alien Life
### [00:11] The Consequences of Ignoring the Signal
# [00:14] The Nostromo
## [00:14] Description of the Spaceship
### [00:14] The Nostromo's Purpose and Cargo
### [00:14] The Crew's Perception of the Ship
## [00:14] The Symbolism of the Ship's Name
### [00:15] The Connection to Joseph Conrad's Novel
### [00:15] The Anti-Capitalist Themes
# [00:16] The Crew's Journey
## [00:16] The Atterrissement on LV-426
### [00:16] The Difficulty of Landing
### [00:16] The Crew's Disagreements
## [00:18] The Investigation of the Signal
### [00:18] Kane's and Dallas's Decision to Investigate
### [00:18] The Discovery of the Alien Ship
## [00:19] The Symbolism of the Alien Ship
### [00:19] The Connection to Hans Rudi Giger's Design
### [00:20] The Use of Symbolism in the Film

# [00:20] Symbolism and Design
## [00:20] The Space Joke
### [00:20] Description of the Space Joke
### [00:21] Connection to Hans Rudi Giger's Design
## [00:21] The Alien Ship
### [00:21] Description of the Alien Ship
### [00:22] Symbolism of the Alien Ship
## [00:22] The Facehugger
### [00:22] Description of the Facehugger
### [00:22] Symbolism of the Facehugger
## [00:23] The Scene with Kane
### [00:23] Description of the Scene
### [00:23] Symbolism of the Scene
## [00:24] The Conversation between Dallas and Kane
### [00:24] Description of the Conversation
### [00:24] Symbolism of the Conversation
## [00:25] The Discovery of the Alien's True Nature
### [00:25] Description of the Discovery
### [00:25] Symbolism of the Discovery
## [00:26] The Scene with Dallas and Kane
### [00:26] Description of the Scene
### [00:26] Symbolism of the Scene
## [00:27] The Conversation between Dallas and Lambert
### [00:27] Description of the Conversation
### [00:27] Symbolism of the Conversation
## [00:28] The Scene with Dallas and Kane
### [00:28] Description of the Scene
### [00:28] Symbolism of the Scene
## [00:29] The Conversation between Dallas and Kane
### [00:29] Description of the Conversation
### [00:29] Symbolism of the Conversation
## [00:30] The Scene with Dallas and Kane
### [00:30] Description of the Scene
### [00:30] Symbolism of the Scene

# [00:30] Symbolism and Design
## [00:30] Camera Angles and Perspective
### [00:30] The use of a low-angle shot to create a sense of danger and voyeurism
### [00:31] The effect of the camera's movement on the audience's perception of the scene
## [00:30] Dallas's Characterization
### [00:31] His heroic and protective nature
### [00:31] The contrast between his actions and his words
## [00:30] The Significance of the Facehugger's Death
### [00:31] The implications of the alien's acidic blood
### [00:31] The contrast between the Facehugger's death and Kane's fate
## [00:30] The Symbolism of the Alien's Body
### [00:31] The connection between the alien's body and the human body
### [00:31] The use of the alien's body as a symbol of the unknown and the uncontrollable
## [00:30] The Significance of the Company's Logo
### [00:31] The use of the company's logo as a symbol of power and control
### [00:31] The contrast between the company's logo and the alien's body
# [00:35] The Scene with Kane
## [00:35] The Use of Sound and Music
### [00:35] The use of sound effects to create tension and suspense
### [00:35] The use of music to create a sense of unease and foreboding
## [00:35] Kane's Characterization
### [00:35] His vulnerability and helplessness
### [00:35] The contrast between his actions and his words
## [00:35] The Significance of the Alien's Birth
### [00:35] The implications of the alien's birth for the human characters
### [00:35] The connection between the alien's birth and the themes of the film
# [00:40] The Symbolism of the Alien's Body
## [00:40] The Connection between the Alien's Body and the Human Body
### [00:40] The use of the alien's body as a symbol of the unknown and the uncontrollable
### [00:40] The connection between the alien's body and the themes of the film
## [00:40] The Significance of the Alien's Acidic Blood
### [00:40] The implications of the alien's acidic blood for the human characters
### [00:40] The connection between the alien's acidic blood and the themes of the film

# [00:40] La Ventilation
## [00:40] Brett entre dans une grande pi�ce
### [00:40] La cam�ra l'accueille au niveau du plafond
### [00:40] Le message de la mise en sc�ne est limpide
## [00:41] L'alien se cache
### [00:41] Beaucoup de gens se posent sans doute la question
### [00:41] Le liquide l� est de la condensation de l'atmosph�re de LV-426
## [00:42] La cr�ature est gigantesque
### [00:42] Elle est silencieuse comme la mort
### [00:42] Elle est monstrueuse
## [00:43] L'alien est 100% adulte
### [00:43] Il se cache n'importe o� dans le vaisseau et se fond dans le d�cor
### [00:43] Il y a un plan qu'ils ont d�cid� de ne pas laisser au montage
## [00:44] Dallas meurt
### [00:44] C'est l� que Dallas meurt d'abord Parker et Replay t�moignent de ce qu'ils ont vu
### [00:44] Dans une sc�ne coup�e, on peut voir qu'ils arrivent juste � temps pour voir l'alien enlever Bret
## [00:45] Le d�tecteur de mouvement continue de biper
### [00:45] Dallas dit la chose qui le chasseur te laissera pas faire
### [00:45] L'alienne se rapproche tr�s rapidement de la position de Dallas
## [00:46] Le tra�tre
### [00:46] H non seulement il a pas dit un mot mais regardez le dernier plan sur lui
### [00:46] Il est pas inquiet pour Dallas il est fascin� par l'alien
## [00:47] Les personnalit�s sont exacerb�es
### [00:47] Chaque personnage a une r�action diff�rente face au danger
### [00:47] H qui semble se renfermer mais c'est un tra�tre
## [00:48] Replay va voir Mother
### [00:48] Elle d�couvre que ramener l'alien sur Terre a toujours �t� l'objectif du Nostromo
### [00:48] Et que les vies de l'�quipage sont secondaires
## [00:49] La sc�ne avec le magazine
### [00:49] Parker et Lambert viennent pour la sauver
### [00:49] Ils veulent assommer H mais surprise c'�tait un andro�de depuis le d�but
## [00:50] Le vrai m�chant
### [00:50] Le vrai antagoniste est la compagnie
### [00:50] Dont le nom n'appara�t � l'�cran que deux ou trois fois

# [00:49] La v�rit� sur l'antagoniste
## [00:49] La compagnie, le vrai m�chant
### [00:49] La compagnie, un choix conscient
### [00:50] La compagnie, un choix qui a des cons�quences
## [00:51] Parker et Lambert, la mort de l'humanit�
### [00:51] La tentative de fuir, l'ali�nation
### [00:52] La mort de Lambert, la violence de l'alien
## [00:52] L'analyse de la sc�ne de mort de Lambert
### [00:52] La critique de la sc�ne, la nudit� de Lambert
### [00:53] La r�action de l'alien, la surprise
## [00:54] Replay, la derni�re trahison
### [00:54] La d�cision de Replay, la mort de Parker
### [00:55] La fuite de Replay, la destruction du Nostromo
## [00:55] La sc�ne finale, l'implication de l'alien
### [00:56] L'alien, plus intelligent que les hommes
### [00:56] L'alien, la survie dans l'espace
## [00:57] La discussion avec David, la nuance de l'analyse
### [00:57] Le d�saccord sur la sc�ne de mort de Lambert
### [00:58] La critique de la sc�ne, la f�minit� de Replay
## [00:59] La r�flexion sur la sc�ne de Replay
### [00:59] La vuln�rabilit� de Replay, la f�minit� triomphante
### [00:59] La critique de la sc�ne, la repr�sentation des genres
## [00:59] Le concept de Mail gaz, la sym�trie dans la repr�sentation
### [00:59] Le point de vue masculin, l'objet de d�sir
### [00:59] Le besoin de changer les st�r�otypes de genre

# [00:59] Le Maale gaz
## [00:59] Conceptualis� par Laura Mulvey en 1975
### [01:00] La sym�trie dans la repr�sentation des genres
## [01:00] Le point de vue masculin et d'�rotisation
### [01:00] Pr�sentation des femmes comme un objet de d�sir
# [01:01] Les animaux
## [01:01] Utilisation de vrais animaux dans le film
### [01:01] Sc�ne du chesseburster
### [01:01] Mort de Bret
# [01:02] Ce cut
## [01:02] Critique du cut dans la sc�ne de la t�te de l'alien
### [01:04] Transition abominable et honteuse
# [01:05] L'atmosph�re
## [01:05] Contribution de l'atmosph�re au film
### [01:06] Impression d'�tre traqu� et en danger
# [01:06] L'ambiance sonore
## [01:06] Importance du son dans le film
### [01:07] �motions et imagination stimul�es par le son
## [01:07] Exemples de construction sonore
### [01:08] D�tecteur de mouvement et son bruit
### [01:08] Mort de Lambirth et son plan

# [01:08] Le d�cor sonore
## [01:08] L'importance du silence
### [01:09] Le silence comme choix sonore
### [01:09] Le silence dans la tension
## [01:09] L'assaisonnement sonore
### [01:09] Le ma�tre de l'assaisonnement sonore
### [01:09] Le r�le du silence dans l'assaisonnement
## [01:09] Les d�cors
### [01:11] Le d�cor principal du film
### [01:12] Le Nostromo
### [01:12] Les plateaux diff�rents
## [01:12] Les personnages
### [01:13] Lumbert
### [01:14] Bret
### [01:14] Parker
### [01:14] Kane
### [01:14] Dallas
### [01:15] Replay
## [01:15] Le tra�tre
### [01:15] L'agent du capitalisme
### [01:16] Le cyborg
## [01:16] La conclusion
### [01:17] Merci � tous pour avoir regard� cet �pisode
### [01:17] Merci pour votre patience
'''



prompt1 = '''
You are an expert in content organization and information architecture.
Your task is to refine and rebalance an existing video outline to ensure optimal hierarchical structure and topic organization.

Input Context:
The following outline was automatically generated from video transcript chunks. While the time codes and content are accurate, the hierarchical structure may need refinement:

{{original_outline}}

Task:
Rewrite the outline to ensure:
1. Logical topic grouping
2. Appropriate hierarchical depth
3. Balanced section scope
4. Clear distinction between main ideas and supporting details

Scope:
- You most cover the entire outline
- Aim for a structure where most content is at levels 2 and 3

Structural Requirements:
Main Sections (Level 1) must:
- Represent truly significant shifts in topic or theme
- Encompass multiple related subtopics
- Be broad enough to warrant subdivision
- Not be too specific or detail-oriented
- Typically span several minutes of content
Subsections (Level 2) must:
- Represent distinct subtopics within the main theme
- Be specific enough to be meaningful
- Be general enough to potentially contain key points
- Have clear relationships to their parent section
Key Points (Level 3) must:
- Contain specific details, examples, or arguments
- Directly support their parent subsection
- Not be so broad that they could be subsections

Rebalancing Rules:
1. If a Level 1 section contains only one subsection, either:
   - Promote the subsection to Level 1 if it's sufficiently important
   - Or merge it with another related section
2. If a Level 1 section is too specific:
   - Demote it to Level 2 and find an appropriate parent section
   - Or combine it with related sections under a new broader heading
3. If multiple Level 2 sections share a common theme:
   - Create a new Level 1 section to group them
   - Ensure the new section title accurately represents the group
4. If Level 3 points are too broad:
   - Promote them to Level 2
   - Create appropriate parent sections as needed

Format Requirements:
- Maintain all original time codes [HH:MM]
- Preserve chronological order
- Keep section titles concise but descriptive
- Do not add explanatory text or commentary
- Do not modify time codes (it's really important)

Output Format:
# [HH:MM] Main Section Title
## [HH:MM] Subsection Title
### [HH:MM] Key Point

Process the outline and provide only the rebalanced version, without any additional text.
'''


p_phase1 = '''
You are an expert in content organization and information architecture.

Your task is to analyze the given outline and identify the true main topics, reorganizing the Level 1 sections to ensure each represents a distinct, coherent theme.

Input:
{{original_outline}}

Task:
1. Analyze the entire outline to identify the major thematic shifts
2. Reorganize Level 1 sections only, while preserving all content and time codes
3. Ensure each main section represents a distinct, substantial topic

Requirements for Main Sections (Level 1):
- Must represent significant thematic shifts in content
- Should be broad enough to encompass multiple related subtopics
- Must be clearly distinguishable from other main sections
- Should typically span several minutes of content
- Must have a clear, unified theme or purpose

Main Section Guidelines:
- If multiple sections discuss related aspects of the same topic, combine them
- If a section is too specific, consider if it belongs under another main topic
- Ensure section titles clearly communicate the overarching theme
- Avoid overlap between main section themes

Rules:
1. Maintain all original time codes [HH:MM]
2. Preserve chronological order
3. Keep existing Level 2 and 3 content under their chronologically appropriate main sections
4. Do not modify the content of Level 2 and 3 items
5. Do not add explanatory text

Output Format:
# [HH:MM] Main Section Title (reorganized)
[Include all existing Level 2 and 3 content in chronological order under new main sections]

Process the outline and provide only the reorganized version with new main sections, keeping all subsections and key points in their original form.
'''


p_phase2 = '''
You are an expert in content organization and information architecture.

Your task is to rebalance and optimize the subsection structure of an outline while maintaining the main sections identified in Phase 1.

Input:
{{phase_1_outline}}

Task:
Rebalance Level 2 and 3 content while:
1. Maintaining the main sections from Phase 1
2. Ensuring logical grouping of subsections
3. Creating appropriate hierarchical relationships

Requirements for Subsections (Level 2):
- Must represent distinct subtopics within their main section
- Should be specific enough to be meaningful
- Should be general enough to potentially contain key points
- Must have clear relationships to their parent section

Requirements for Key Points (Level 3):
- Must contain specific details, examples, or arguments
- Must directly support their parent subsection
- Should not be so broad that they could be subsections

Rebalancing Rules:
1. If multiple Level 2 sections are closely related:
   - Group them under a new, more general Level 2 heading
   - Convert them to Level 3 points if appropriate

2. If a Level 2 section is too specific:
   - Convert it to a Level 3 point
   - Find or create an appropriate Level 2 parent

3. If a Level 3 point is too general:
   - Promote it to Level 2
   - Create appropriate Level 3 points beneath it

4. Ensure balanced distribution:
   - Level 2 sections should have roughly similar scope
   - Each Level 2 section should ideally have multiple Level 3 points

Rules:
1. Do not modify main sections from Phase 1
2. Maintain all time codes [HH:MM]
3. Preserve chronological order
4. Keep content concise but descriptive
5. Do not add explanatory text

Output Format:
# [HH:MM] Main Section Title (from Phase 1)
## [HH:MM] Rebalanced Subsection Title
### [HH:MM] Rebalanced Key Point

Provide only the final rebalanced outline without additional text.
'''








from Generator import Generator

g = Generator()

phase_1 = g.generate_chat_completion("",prompt1.replace("{{original_outline}}",outline))
r = g.generate_chat_completion("",p_phase2.replace("{{phase_1_outline}}",phase_1))

print(r)